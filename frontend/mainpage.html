<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TI-Hunt Platform</title>
  <link rel="stylesheet" href="mainpage.css" />
</head>
<body>
  <nav class="navbar">
    <div class="nav-brand">
      <div class="logo">
        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
          <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
        </svg>
      </div>
      <h1>TI-Hunt</h1>
    </div>
    <div class="profile">
      <button class="profile-btn">
        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
      </button>
    </div>
  </nav>

  <div class="container">
    <aside class="sidebar">
      <ul>
        <li><a href="IPSEARCH/IPSEARCH.html">IP Scanning</a></li>
        <li><a href="URLSCAN/URLSCAN.html">URL Scanning</a></li>
        <li><a href="DOMAINHASH/DH.html">HASH/DOMAIN Scanning</a></li>
        <li><a href="community.html">Community Forum</a></li>
      </ul>
      <a href="l1.html" class="logout">
        <svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
          <polyline points="16 17 21 12 16 7"/>
          <line x1="21" y1="12" x2="9" y2="12"/>
        </svg>
        Logout
      </a>
    </aside>

    <main class="main-content">
      <section class="log-analysis">
        <h2>Log File Analysis</h2>
        <p class="description">Upload your log file to scan for threats and vulnerabilities</p>
        
        <div class="upload-container">
          <div class="upload-area" id="dropZone">
            <svg viewBox="0 0 24 24" width="48" height="48" stroke="currentColor" stroke-width="2" fill="none">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17 8 12 3 7 8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            <p>Drag and drop your file here or</p>
            <label for="fileInput" class="upload-btn">Choose File</label>
            <input type="file" id="fileInput" accept=".log,.txt" hidden />
          </div>
        </div>

        <div class="results hidden" id="results">
          <div class="scanning-animation" id="scanning">
            <div class="spinner"></div>
            <p>Analyzing log file...</p>
            <div class="progress-bar">
              <div class="progress"></div>
            </div>
          </div>

          <div class="threats-container">
            <h3>Detected Threats</h3>
            <div class="threat-cards">
              <div class="threat-card critical">
                <h4>SQL Injection Attempt</h4>
                <p>Multiple SQL injection attempts detected from IP 192.168.1.45</p>
                <span class="severity">Critical</span>
              </div>
              <div class="threat-card high">
                <h4>Suspicious PowerShell Command</h4>
                <p>Base64 encoded PowerShell command detected</p>
                <span class="severity">High</span>
              </div>
              <div class="threat-card medium">
                <h4>Failed Login Attempts</h4>
                <p>Multiple failed login attempts from single IP</p>
                <span class="severity">Medium</span>
              </div>
            </div>
          </div>

          <div class="ioc-container">
            <h3>Indicators of Compromise</h3>
            <table class="ioc-table">
              <thead>
                <tr>
                  <th>Type</th>
                  <th>Value</th>
                  <th>Confidence</th>
                  <th>Source</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>IP Address</td>
                  <td>192.168.1.45</td>
                  <td><div class="confidence-bar" style="--confidence: 95%"></div></td>
                  <td>Local Log</td>
                </tr>
                <tr>
                  <td>Domain</td>
                  <td>malware-delivery.xyz</td>
                  <td><div class="confidence-bar" style="--confidence: 87%"></div></td>
                  <td>VirusTotal</td>
                </tr>
                <tr>
                  <td>Hash</td>
                  <td>a3ded43a54c3a5c3aa7b91988881267c</td>
                  <td><div class="confidence-bar" style="--confidence: 78%"></div></td>
                  <td>MISP</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="charts-container">
            <div class="severity-chart">
              <h3>Threat Severity Distribution</h3>
              <div class="donut-chart">
                <div class="chart-legend">
                  <div class="legend-item"><span class="color critical"></span>Critical (15%)</div>
                  <div class="legend-item"><span class="color high"></span>High (25%)</div>
                  <div class="legend-item"><span class="color medium"></span>Medium (40%)</div>
                  <div class="legend-item"><span class="color low"></span>Low (20%)</div>
                </div>
              </div>
            </div>
            <div class="ioc-chart">
              <h3>IOC Type Distribution</h3>
              <div class="bar-chart">
                <div class="bar" style="--height: 75%"><span>IP</span></div>
                <div class="bar" style="--height: 45%"><span>Domain</span></div>
                <div class="bar" style="--height: 60%"><span>Hash</span></div>
                <div class="bar" style="--height: 30%"><span>URL</span></div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const dropZone = document.getElementById('dropZone');
    const fileInput = document.getElementById('fileInput');
    const results = document.getElementById('results');
    const scanning = document.getElementById('scanning');

    dropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dropZone.classList.add('dragover');
    });

    dropZone.addEventListener('dragleave', () => {
      dropZone.classList.remove('dragover');
    });

    dropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dropZone.classList.remove('dragover');
      handleFile(e.dataTransfer.files[0]);
    });

    fileInput.addEventListener('change', (e) => {
      handleFile(e.target.files[0]);
    });

    function handleFile(file) {
      if (file) {
        results.classList.remove('hidden');
        scanning.classList.remove('hidden');
        dropZone.classList.add('hidden');
        
        setTimeout(() => {
          scanning.classList.add('hidden');
          document.querySelector('.threats-container').style.display = 'block';
          document.querySelector('.ioc-container').style.display = 'block';
          document.querySelector('.charts-container').style.display = 'grid';
        }, 3000);
      }
    }
  </script>
</body>
</html>
